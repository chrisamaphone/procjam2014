Solution: \X1. {
    let {[X2, [X3, [X4, [X5, X6]]]]} = X1 in 
    let {[X7, X8]} = pickup !alice !bedroom !revolver [X2, [X4, portable/revolver]] in 
    let {X9} = move !bob !front_hall !bathroom [X3, -] in 
    let {[X10, X11]} = observe !bob !bathroom !dead_body [X9, X6] in 
    let {[X12, X13]} = drop !alice !bedroom !revolver [X7, X8] in 
    let {[X14, X15]} = observe !bob !bathroom !dead_body [X10, X11] in 
    let {X16} = move !alice !bedroom !courtyard [X12, -11] in 
    let {[X17, X18]} = pickup !alice !courtyard !maltese_falcon [X16, [X5, portable/mf]] in 
    let {[X19, X20]} = drop !alice !courtyard !maltese_falcon [X17, X18] in 
    let {[X21, X22]} = pickup !alice !courtyard !maltese_falcon [X19, [X20, portable/mf]] in 
    let {[X23, X24]} = observe !bob !bathroom !dead_body [X14, X15] in 
    let {[X25, X26]} = drop !alice !courtyard !maltese_falcon [X21, X22] in 
    let {[X27, X28]} = pickup !alice !courtyard !maltese_falcon [X25, [X26, portable/mf]] in 
    let {[X29, X30]} = observe !bob !bathroom !dead_body [X23, X24] in 
    let {[X31, X32]} = drop !alice !courtyard !maltese_falcon [X27, X28] in 
    let {[X33, X34]} = pickup !alice !courtyard !maltese_falcon [X31, [X32, portable/mf]] in 
    let {[X35, X36]} = drop !alice !courtyard !maltese_falcon [X33, X34] in 
    let {[X37, X38]} = pickup !alice !courtyard !maltese_falcon [X35, [X36, portable/mf]] in 
    let {[X39, X40]} = drop !alice !courtyard !maltese_falcon [X37, X38] in 
    let {[X41, X42]} = pickup !alice !courtyard !maltese_falcon [X39, [X40, portable/mf]] in 
    let {[X43, X44]} = drop !alice !courtyard !maltese_falcon [X41, X42] in 
    let {X45} = move !bob !bathroom !courtyard [X29, -4] in 
    let {[X46, X47]} = comment_on_location !alice !bob !courtyard [X43, X45] in 
    let {X48} = move !alice !courtyard !bathroom [X46, -7] in 
    let {X49} = move !alice !bathroom !courtyard [X48, -4] in 
    let {[X50, X51]} = pickup !bob !courtyard !maltese_falcon [X47, [X44, portable/mf]] in 
    let {[X52, [X53, X54]]} = observe_with !alice !bob !courtyard !maltese_falcon [X49, [X50, X51]] in 
    let {[X55, X56]} = greet !alice !bob !courtyard [X52, X53] in 
    let {[X57, X58]} = comment_on_location !alice !bob !courtyard [X55, X56] in 
    let {[X59, X60]} = greet !alice !bob !courtyard [X57, X58] in 
    let {[X61, [X62, X63]]} = observe_with !alice !bob !courtyard !maltese_falcon [X59, [X60, X54]] in 
    let {[X64, X65]} = comment_on_location !alice !bob !courtyard [X61, X62] in 
    let {[X66, X67]} = greet !alice !bob !courtyard [X64, X65] in 
    let {[X68, X69]} = drop !bob !courtyard !maltese_falcon [X67, X63] in 
    let {[X70, X71]} = observe !alice !courtyard !maltese_falcon [X66, X69] in 
    let {X72} = move !bob !courtyard !bathroom [X68, -7] in 
    let {X73} = move !bob !bathroom !front_hall [X72, -3] in 
    let {[X74, X75]} = pickup !alice !courtyard !maltese_falcon [X70, [X71, portable/mf]] in 
    let {X76} = move !bob !front_hall !bedroom [X73, -1] in 
    let {X77} = move !alice !courtyard !bedroom [X74, -8] in 
    let {[X78, X79]} = comment_on_location !bob !alice !bedroom [X76, X77] in 
    let {[X80, X81]} = pickup !bob !bedroom !revolver [X78, [X13, portable/revolver]] in 
    let {[X82, X83]} = drop !bob !bedroom !revolver [X80, X81] in 
    let {X84} = move !alice !bedroom !courtyard [X79, -11] in 
    let {[X85, X86]} = observe !bob !bedroom !revolver [X82, X83] in 
    let {[X87, X88]} = observe !bob !bedroom !revolver [X85, X86] in 
    let {[X89, X90]} = pickup !bob !bedroom !revolver [X87, [X88, portable/revolver]] in 
    let {[X91, X92]} = drop !alice !courtyard !maltese_falcon [X84, X75] in 
    let {X93} = move !alice !courtyard !bathroom [X91, -7] in 
    let {X94} = move !bob !bedroom !front_hall [X89, -9] in 
    let {[X95, X96]} = drop !bob !front_hall !revolver [X94, X90] in 
    let {[X97, X98]} = pickup !bob !front_hall !revolver [X95, [X96, portable/revolver]] in 
    let {[X99, X100]} = drop !bob !front_hall !revolver [X97, X98] in 
    let {X101} = move !bob !front_hall !bedroom [X99, -1] in 
    let {[X102, X103]} = observe !alice !bathroom !dead_body [X93, X30] in 
    let {X104} = move !alice !bathroom !front_hall [X102, -3] in 
    let {[X105, X106]} = pickup !alice !front_hall !revolver [X104, [X100, portable/revolver]] in 
    let {X107} = move !alice !front_hall !bedroom [X105, -1] in 
    let {[X108, [X109, X110]]} = threaten_with_revolver !alice !bob !bedroom [X107, [X101, X106]] in 
    let {[X111, [X112, X113]]} = observe_with !bob !alice !bedroom !revolver [X109, [X108, X110]] in 
    let {X114} = move !alice !bedroom !bathroom [X112, -10] in 
    let {X115} = move !alice !bathroom !courtyard [X114, -4] in 
    let {[X116, X117]} = drop !alice !courtyard !revolver [X115, X113] in 
    let {[X118, X119]} = observe !alice !courtyard !revolver [X116, X117] in 
    let {X120} = move !bob !bedroom !front_hall [X111, -9] in 
    let {[X121, X122]} = observe !alice !courtyard !revolver [X118, X119] in 
    let {[X123, X124]} = observe !alice !courtyard !revolver [X121, X122] in 
    let {[X125, X126]} = pickup !alice !courtyard !maltese_falcon [X123, [X92, portable/mf]] in 
    let {[X127, X128]} = pickup !alice !courtyard !revolver [X125, [X124, portable/revolver]] in 
    let {[X129, X130]} = drop !alice !courtyard !maltese_falcon [X127, X126] in 
    let {[X131, X132]} = observe !alice !courtyard !maltese_falcon [X129, X130] in 
    let {[X133, X134]} = observe !alice !courtyard !maltese_falcon [X131, X132] in 
    let {[X135, X136]} = observe !alice !courtyard !maltese_falcon [X133, X134] in 
    let {X137} = move !alice !courtyard !bathroom [X135, -7] in 
    let {[X138, X139]} = drop !alice !bathroom !revolver [X137, X128] in 
    let {[X140, X141]} = observe !alice !bathroom !dead_body [X138, X103] in 
    let {X142} = move !bob !front_hall !bedroom [X120, -1] in 
    let {[X143, X144]} = pickup !alice !bathroom !revolver [X140, [X139, portable/revolver]] in 
    let {X145} = move !bob !bedroom !front_hall [X142, -9] in 
    let {[X146, X147]} = observe !alice !bathroom !dead_body [X143, X141] in 
    let {[X148, X149]} = observe !alice !bathroom !dead_body [X146, X147] in 
    let {X150} = move !bob !front_hall !courtyard [X145, -2] in 
    let {[X151, X152]} = drop !alice !bathroom !revolver [X148, X144] in 
    let {[X153, X154]} = pickup !bob !courtyard !maltese_falcon [X150, [X136, portable/mf]] in 
    let {X155} = move !bob !courtyard !bedroom [X153, -8] in 
    let {[X156, X157]} = observe !alice !bathroom !revolver [X151, X152] in 
    let {[X158, X159]} = drop !bob !bedroom !maltese_falcon [X155, X154] in 
    let {X160} = move !bob !bedroom !front_hall [X158, -9] in 
    let {X161} = move !bob !front_hall !courtyard [X160, -2] in 
    let {X162} = move !bob !courtyard !bedroom [X161, -8] in 
    let {X163} = move !alice !bathroom !courtyard [X156, -4] in 
    let {X164} = move !bob !bedroom !front_hall [X162, -9] in 
    let {X165} = move !bob !front_hall !courtyard [X164, -2] in 
    let {X166} = move !bob !courtyard !front_hall [X165, -6] in 
    let {X167} = move !alice !courtyard !front_hall [X163, -6] in 
    let {1} = leave [X167, X166] in [X159, [X149, X157]]}

